<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>WebGL-乗算済みアルファテスト - js do it</title>
<meta name="Description" content="" />
<meta name="Keywords"  content="" />

<link rel="stylesheet" type="text/css" media="screen,print" href="style.css" />
</head>
<body>
<!-- generated by: jsdo.it - http://jsdo.it/.naotaro/iVof -->
<!-- Copyright .naotaro - http://jsdo.it/.naotaro -->
<!-- Licensed under MIT License - http://www.opensource.org/licenses/mit-license.php -->
<!-- 頂点シェーダー -->
<script id="vs" type="x-shader/x-vertex">
attribute vec3 position;
attribute vec4 color;
attribute vec2 textureCoord;
uniform   mat4 mvpMatrix;
varying   vec4 vColor;
varying   vec2 vTextureCoord;

void main(void){
    vColor        = color;
    vTextureCoord = textureCoord;
    gl_Position   = mvpMatrix * vec4(position, 1.0);
}
</script>
<!-- フラグメントシェーダー -->
<script id="fs" type="x-shader/x-fragment">
precision mediump float;

uniform sampler2D texture;
uniform int premultipliedAlpha;
varying vec4      vColor;
varying vec2      vTextureCoord;

void main(void){
    vec4 smpColor = texture2D(texture, vTextureCoord);
    vec4 color = vec4(smpColor.rgb * vColor.rgb, smpColor.a * vColor.a);
    // Nonプリマルチプライドの場合、乗算済みアルファにする
//    if(premultipliedAlpha == 0){
        color = vec4(color.rgb * color.a, color.a);
//    }
        
    gl_FragColor  = color;
}
</script>
<canvas id="glcanvas"></canvas>
<div class="selectbtn">
    <p>texture</p>
    <select id="textures">
        <option>Non PremultipliedAlpha-image</option>
        <option selected>PremultipliedAlpha-image</option>
    </select>

    <p>color equation</p>
    <select id="m1cEquation">
        <option selected>gl.FUNC_ADD</option>
        <option>gl.FUNC_SUBTRACT</option>
        <option>gl.FUNC_REVERSE_SUBTRACT</option>
    </select>

    <p>alpha equation</p>
    <select id="m1aEquation">
        <option selected>gl.FUNC_ADD</option>
        <option>gl.FUNC_SUBTRACT</option>
        <option>gl.FUNC_REVERSE_SUBTRACT</option>
    </select>

    <p>src alpha blend</p>
    <select id="m1aSrcBlendFunc">
        <option>gl.ZERO</option>
        <option selected>gl.ONE</option>
        <option>gl.SRC_COLOR</option>
        <option>gl.DST_COLOR</option>
        <option>gl.ONE_MINUS_SRC_COLOR</option>
        <option>gl.ONE_MINUS_DST_COLOR</option>
        <option>gl.SRC_ALPHA</option>
        <option>gl.DST_ALPHA</option>
        <option>gl.ONE_MINUS_SRC_ALPHA</option>
        <option>gl.ONE_MINUS_DST_ALPHA</option>
        <option>gl.CONSTANT_COLOR</option>
        <option>gl.ONE_MINUS_CONSTANT_COLOR</option>
        <option>gl.CONSTANT_ALPHA</option>
        <option>gl.ONE_MINUS_CONSTANT_ALPHA</option>
        <option>gl.SRC_ALPHA_SATURATE</option>
    </select>

    <p>dest alpha blend</p>
    <select id="m1aDstBlendFunc">
        <option>gl.ZERO</option>
        <option>gl.ONE</option>
        <option>gl.SRC_COLOR</option>
        <option>gl.DST_COLOR</option>
        <option>gl.ONE_MINUS_SRC_COLOR</option>
        <option>gl.ONE_MINUS_DST_COLOR</option>
        <option>gl.SRC_ALPHA</option>
        <option>gl.DST_ALPHA</option>
        <option selected>gl.ONE_MINUS_SRC_ALPHA</option>
        <option>gl.ONE_MINUS_DST_ALPHA</option>
        <option>gl.CONSTANT_COLOR</option>
        <option>gl.ONE_MINUS_CONSTANT_COLOR</option>
        <option>gl.CONSTANT_ALPHA</option>
        <option>gl.ONE_MINUS_CONSTANT_ALPHA</option>
    </select>

    <p>src color blend</p>
    <select id="m1cSrcBlendFunc">
        <option>gl.ZERO</option>
        <option selected>gl.ONE</option>
        <option>gl.SRC_COLOR</option>
        <option>gl.DST_COLOR</option>
        <option>gl.ONE_MINUS_SRC_COLOR</option>
        <option>gl.ONE_MINUS_DST_COLOR</option>
        <option>gl.SRC_ALPHA</option>
        <option>gl.DST_ALPHA</option>
        <option>gl.ONE_MINUS_SRC_ALPHA</option>
        <option>gl.ONE_MINUS_DST_ALPHA</option>
        <option>gl.CONSTANT_COLOR</option>
        <option>gl.ONE_MINUS_CONSTANT_COLOR</option>
        <option>gl.CONSTANT_ALPHA</option>
        <option>gl.ONE_MINUS_CONSTANT_ALPHA</option>
        <option>gl.SRC_ALPHA_SATURATE</option>
    </select>

    <p>dest color blend</p>
    <select id="m1cDstBlendFunc">
        <option>gl.ZERO</option>
        <option>gl.ONE</option>
        <option>gl.SRC_COLOR</option>
        <option>gl.DST_COLOR</option>
        <option>gl.ONE_MINUS_SRC_COLOR</option>
        <option>gl.ONE_MINUS_DST_COLOR</option>
        <option>gl.SRC_ALPHA</option>
        <option>gl.DST_ALPHA</option>
        <option selected>gl.ONE_MINUS_SRC_ALPHA</option>
        <option>gl.ONE_MINUS_DST_ALPHA</option>
        <option>gl.CONSTANT_COLOR</option>
        <option>gl.ONE_MINUS_CONSTANT_COLOR</option>
        <option>gl.CONSTANT_ALPHA</option>
        <option>gl.ONE_MINUS_CONSTANT_ALPHA</option>
    </select>

</div>


<script type="text/javascript" src="http://jsdo.it/.naotaro/2FBP/js"></script>

<script type="text/javascript" src="index.js"></script>
</body>
</html>
